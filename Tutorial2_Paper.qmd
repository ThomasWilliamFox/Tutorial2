---
title: "Tutorial 2: Public Library Computer Work Station Usage"
format: pdf
editor: visual
author: Thomas Fox
date: January 16, 2024
---

In recent years, municipal public libraries have increaslingly become spaces that work to facilitate community building and access to technology.

The major political parties in Canada are the Liberal Party and the Conservative Party. The Bloc Que패be패cois, the New Democratic Party (NDP), and the Green Party are the less popular political parties in Canada. The country is also home to numerous small parties and independent candidates. In this tutorial, I analyzed
Elections Canada Data to determine how many seats were secured by each party during the 2021 Canadian Federal Election.				

I began by sketching the required data that would be needed and a visual
representation of the graph that would be produced after analyzing the data (see Figure 1). I
then simulated the required data set by randomly assigning a political party for each of the 338
seats in the Canadian Parliament. After this, I gathered the Elections Canada data from the
Telling Stories with Data website (Alexander, 2024).

The next step was processing and cleaning the data set to align with my use case by
using the statistical programming language R (R Core Team, 2023). I did so with the help of the
tutorial specification and my completed Australian Election example from Chapter Two in
Telling Stories with Data as a guide (Alexander, 2024). Throughout this process, I also used the R
language packages, tidyverse (Wickham et al., 2019) and janitor (Firke, 2023) as specified in the
tutorial guide. I then constructed a graph to represent the distribution of seats among the five
Canadian political parties after the 2021 Canadian Federal Election (see Figure 2).

I found that the Liberal Party held the most seats after the election at 162. They were
followed by the Conservative Party who held 119 seats following the election. Of the minor
Canadian Political parties, the Bloc Que패be패cois held the most seats with 32 followed by the New
Democrats with 25. I also found that the Green Party won only 2 seats during the election.

The win by the Liberal party may have been the result of the COVID-19 era election.
After two turbulent and uncertain years of the global pandemic, the Canadian public may have
been unwilling to endorse a change in government. Calling the election during that time may
have been a strategic move by the liberals if the decision was in alignment with polling data
suggesting a liberal win at the time.

```{r}
#| echo: false
#| include: false
#| warning: false
#| message: false

#### Preamble ####
# Purpose: Collect, clean, and present opendatatoronto data set
# Author: Thomas Fox
# Email: thomas.fox@mail.utoronto.ca
# Date: 16 January 2024
# Prerequisites: 

#### Workspace setup ####

library(janitor)
library(opendatatoronto)
library(tidyverse)
library(dplyr)
library(knitr)

```

```{r}
#| echo: false
#| include: false
#| warning: false
#| message: false
#| 
#### Acquire Data ####
# Acquires data from Open Data Toronto according to "For Developers" instructions

# get package
package <- show_package("c5e2fdc6-9190-4205-bc04-0c3ce265d005")
package
 
# get all resources for this package
resources <- list_package_resources("c5e2fdc6-9190-4205-bc04-0c3ce265d005")
 
# identify datastore resources; by default, Toronto Open Data sets datastore resource format to CSV for non-geospatial and GeoJSON for geospatial resources
datastore_resources <- filter(resources, tolower(format) %in% c('csv', 'geojson'))
 
# load the first datastore resource as a sample
toronto_library_comp_usage <- filter(datastore_resources, row_number()==1) %>% get_resource()
toronto_library_comp_usage

# write initial data set to .csv file  
head(toronto_library_comp_usage)
write_csv(
  x = toronto_library_comp_usage,
  file = "toronto_library_comp_usage.csv"
)
```

```{r}
#| echo: false
#| include: false
#| warning: false
#| message: false

#### Clean Data ####

# clean column names, select year and session columns, and change sessions from char to int. 
cleaned_toronto_library_comp_usage <-
  clean_names(toronto_library_comp_usage) |>
  select(year, sessions) |>
  mutate (sessions = as.integer(sessions))

# print head to confirm cleaning
head(cleaned_toronto_library_comp_usage)

# write cleaned data set to .csv file
write_csv(
  x = cleaned_toronto_library_comp_usage,
  file = "cleaned_toronto_library_permits.csv"
)
```

```{r}
#| echo: false
#| include: false
#| warning: false
#| message: false

#Summarize data by average sessions per branch by year 

cleaned_toronto_library_comp_usage <-
  cleaned_toronto_library_comp_usage |>
    summarise(total_sessions = mean(sessions),
            .by = year) 
head(cleaned_toronto_library_comp_usage)
```

```{r}
#| echo: false
#| include: true
#| warning: false
#| message: false
#| label: fig-uniquename
#| fig-cap: Average number of yearly Toronto Public Library computer work station sessions per branch, based on data from 2018 - 2022 obtained from Open Data Toronto.

#### Explore ####

# build graph with x-axis as years and y-axis as average sessions per branch 
cleaned_toronto_library_comp_usage |>
  ggplot(aes(x = year, y = total_sessions)) +
  geom_bar(stat = "identity") +
  theme_minimal() + # Make the theme neater
  labs(x = "Party", y = "Avg Sessions Per Branch") # Make labels more meaningful
```
